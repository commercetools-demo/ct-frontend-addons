import{a as ge}from"./chunk-Z47A3HLT.js";var Fe={};ge(Fe,{COMPONENTS:()=>Jt,HOOKS:()=>Gt,PROVIDERS:()=>Qt});import{useCallback as Mt}from"react";import{mutate as Lt}from"swr";var ye=({sdk:r,mutatePath:e="/action/cart/getCart"})=>({changePrice:Mt(async(n,o)=>{let i={lineItemId:n,price:o},s=await r.callAction({actionName:"cart/changePrice",payload:i});Lt(e,s)},[])});import{useState as Et}from"react";import{mutate as oe}from"swr";var Ee=({sdk:r,data:e,setError:t,formatMessage:n,onLogin:o})=>{let[i,s]=Et(!1),l=y=>{if(y.message.includes("CSR")){s(!0),t(n({id:"csr.login",defaultMessage:"Please enter the customer's email address"}));return}},a=async()=>{try{let v=await r.composableCommerce.account.login({email:e.email,password:e.password,remember:e.rememberMe});if(oe("/action/account/getAccount"),oe("/action/cart/getCart"),oe("/action/wishlist/getWishlist"),v.isError)throw v.error;v.data.accountId?o?.():t(n({id:"auth.wrong",defaultMessage:"Wrong email address or password"}))}catch(y){l(y),t(n({id:"wentWrong",defaultMessage:"Sorry. Something went wrong.."}))}},d=async(y,v,h)=>{let g={email:y,password:v,impersonatedCustomerEmail:h},m=await r.callAction({actionName:"account/loginCSR",payload:g});if(oe("/action/account/getAccount"),oe("/action/cart/getCart"),oe("/action/wishlist/getWishlist"),m.isError)throw m.error;return m.data};return{isCSRLogin:i,csrErrorHandler:l,login:()=>{i?d(e.email,e.password,e.impersonatedCustomerEmail):a()}}};import be,{useCallback as Ne,useMemo as Ae,useState as Se}from"react";import{useParams as Vt}from"next/navigation";import Ut from"lodash.debounce";var Ve=function(r){return r?r.split("_")[0]:"en"},Ue=function(r,e){return Intl.NumberFormat(Ve(e),{style:"currency",currency:r?.currencyCode??"USD",maximumFractionDigits:r?.fractionDigits??0,minimumFractionDigits:r?.fractionDigits??0}).format((r?.centAmount??0)/100)},we=function(r,e,t="USD",n=0){return Intl.NumberFormat(Ve(e),{style:"currency",currency:t??"USD",maximumFractionDigits:n??0,minimumFractionDigits:n??0}).format((r??0)/100)};var qt=({item:r,price:e,sdk:t,buttonText:n,wrapperClassName:o,priceClassName:i,buttonClassName:s,buttonWrapperClassName:l})=>{let{changePrice:a}=ye({sdk:t}),{locale:d}=Vt(),[p,y]=Se((e?.centAmount||0)/100),[v,h]=Se(Ue(e,d)),[g,m]=Se(!1),c=Ae(()=>e?.currencyCode,[e]),u=Ae(()=>e?.fractionDigits,[e]),b=Ae(()=>p!==(e?.centAmount||0)/100,[p,e]),x=Ne(async()=>{m(!0),r.lineItemId&&await a(r.lineItemId,{centAmount:p*100,currencyCode:e?.currencyCode}),m(!1)},[p,r]),w=Ne(Ut(O=>{let E=parseFloat(O.replace(/[^0-9\.]/g,""));if(isNaN(E))return;y(E);let C=we(E*100,d,c,u);h(C)},1e3),[c,u,d]),D=Ne(O=>{let E=O.target.value;h(E),w(E)},[w]);return be.createElement("div",{className:o},be.createElement("input",{value:v,className:i,type:"text",onChange:D,disabled:g,onBlur:()=>h(we(p*100,d,c,u))}),be.createElement("div",{className:l},be.createElement("button",{disabled:!b||g,onClick:x,type:"button",className:s},n)))},Pe=qt;import zt,{createContext as Wt,useContext as Ht,useState as Kt}from"react";var _t={superUserData:void 0,setSuperUser:()=>{}},qe=Wt(_t),ze=({children:r,initialSuperUserData:e})=>{let[t,n]=Kt(e);return zt.createElement(qe.Provider,{value:{setSuperUser:n,superUserData:t}},r)},We=()=>Ht(qe);var Qt={SuperUserProvider:ze,useSuperUserContext:We},Jt={StandalonePriceInput:Pe},Gt={useStandalonePrice:ye,useCSRLoginForm:Ee};var ke={};ge(ke,{COMPONENTS:()=>xr,PROVIDERS:()=>Cr,hooks:()=>hr});import Xt,{createContext as Yt,useContext as Zt,useState as Rt}from"react";var er={configurableComponents:[],selectedVariants:[],productAttributes:[],setSelectedVariants:()=>{}},He=Yt(er),tr=({children:r,configurableComponents:e,productAttributes:t})=>{let[n,o]=Rt(Array(e?.length).fill(null));return Xt.createElement(He.Provider,{value:{configurableComponents:e,selectedVariants:n,setSelectedVariants:o,productAttributes:t}},r)},Ke=tr,G=()=>Zt(He);import rr,{createContext as or,useContext as nr}from"react";var sr={cart:void 0,productAttributes:[]},_e=or(sr),ar=({cart:r,productAttributes:e,children:t})=>rr.createElement(_e.Provider,{value:{productAttributes:e,cart:r}},t),Qe=ar,ne=()=>nr(_e);import pe,{useMemo as lr}from"react";import{useParams as dr}from"next/navigation";var ee="bundled_components",ir=()=>{let{cart:r}=ne(),e=o=>(i,s,l)=>{let a=o(i,s,l);return a.error||!a.data?a:{...a,data:n(a.data)}},t=o=>{let i=r?.lineItems?.find(a=>a.lineItemId===o.id);if(!i)return{price:0,discountedPrice:0};let s=i.variant?.discountedPrice?.centAmount;if(!i.variant?.attributes?.[ee])return{price:0,discountedPrice:0};let l=(i.variant?.attributes?.[ee]).reduce((a,d)=>a+(d.price?.centAmount||0),0);return{price:l,discountedPrice:s?s+l:void 0}},n=o=>{let i=o.lineItems;if(o&&i?.length){let s=i?.filter(a=>!!a.parentId),l=i?.filter(a=>!a.parentId);return{...o,lineItems:l?.map(a=>{a.variant?.attributes||(a={...a,variant:{...a.variant,sku:a.sku,attributes:{}}});let d=s?.filter(p=>p.parentId===a.lineItemId);return a.variant?.attributes&&(a.variant.attributes[ee]=[]),d?.forEach(p=>{a.variant?.attributes?.[ee].push(p)}),{...a}})}}return o};return{bundleComponentsIntoLineItems:n,getBundledPrice:t,swrBundleMiddleware:e}},Je=ir;var se=({productAttributes:r})=>({findAttributeLabel:t=>{let n="";return Object.keys(t||{}).forEach(o=>{r.includes(o)&&(n=t?.[o])}),n}});var ae=class{};ae.isNumeric=e=>!isNaN(+e),ae.capitaliseFirstLetter=e=>e.charAt(0).toUpperCase()+e.slice(1);var z=class z{};z.formatNumberForCurrency=function(e,t,n="USD",o=0){return z.formatMoneyCurrency({centAmount:e,currencyCode:n,fractionDigits:o},t)},z.formatStringForCurrency=function(e,t,n="USD",o=0){return ae.isNumeric(e)?z.formatNumberForCurrency(parseInt(e,10),t,n,o):(console.error(new Error(`Value (${e}) passed for currency formatting cannot be parsed to a number`)),"")},z.getLocaleFromShortenedLocale=function(e){return{en:"en-US",de:"de-DE"}[e]??e},z.formatMoneyCurrency=function(e,t){return Intl.NumberFormat(z.getLocaleFromShortenedLocale(t),{style:"currency",currency:e?.currencyCode??"USD",maximumFractionDigits:e?.fractionDigits??0,minimumFractionDigits:e?.fractionDigits??0}).format((e?.centAmount??0)/100)},z.formatForCurrency=(e,t,n="USD",o=0)=>typeof e=="string"?z.formatStringForCurrency(e,t,n,o):typeof e=="number"?z.formatNumberForCurrency(e,t,n,o):z.formatMoneyCurrency(e,t),z.addCurrency=(e,t)=>(e||(e={centAmount:0}),t||(t={centAmount:0}),e.fractionDigits!==t.fractionDigits&&e.fractionDigits&&t.fractionDigits&&console.warn(new Error(`Money with different fraction codes passed to addCurrency, value returned will be innacurate. Value 1: ${e.fractionDigits}, value 2: ${t.fractionDigits}`)),e.currencyCode!==t.currencyCode&&e.currencyCode&&t.currencyCode&&console.warn(new Error(`Money with different currency codes passed to addCurrency, value returned will be innacurate. Value 1: ${e.currencyCode}, value 2: ${t.currencyCode}`)),{fractionDigits:e.fractionDigits||t.fractionDigits,centAmount:e.centAmount+t.centAmount,currencyCode:e.currencyCode||t.currencyCode}),z.subtractCurrency=(e,t)=>(e.fractionDigits!==t.fractionDigits&&console.warn(new Error(`Money with different fraction codes passed to addCurrency, value returned will be innacurate. Value 1: ${e.fractionDigits}, value 2: ${t.fractionDigits}`)),e.currencyCode!==t.currencyCode&&console.warn(new Error(`Money with different currency codes passed to addCurrency, value returned will be innacurate. Value 1: ${e.currencyCode}, value 2: ${t.currencyCode}`)),{fractionDigits:e.fractionDigits||t.fractionDigits,centAmount:e.centAmount-t.centAmount,currencyCode:e.currencyCode||t.currencyCode}),z.multiplyCurrency=(e,t)=>({fractionDigits:e.fractionDigits,centAmount:e.centAmount*t,currencyCode:e.currencyCode});var M=z;var pr=({item:r})=>{let{cart:e,productAttributes:t}=ne(),{findAttributeLabel:n}=se({productAttributes:t}),{locale:o}=dr(),i=lr(()=>e?.lineItems?.find(s=>s.lineItemId===r.id),[e,r]);return i?pe.createElement("div",null,!!i.variant?.attributes?.[ee]?.length&&i.variant?.attributes?.[ee].map(s=>pe.createElement("div",{className:"flex items-center",key:s.lineItemId},pe.createElement("p",{className:"text-12 font-semibold leading-loose text-gray-600"},`${s.name}:`,pe.createElement("span",{className:"ml-2 text-10 font-normal"},`${n(s.variant?.attributes)}`)),pe.createElement("p",{className:"ml-2 text-10 font-normal leading-loose text-gray-600"},s.price?.centAmount?` ${M.formatForCurrency(s.price,o)}`:"")))):null},Ge=pr;import T,{useEffect as Ye,useState as me}from"react";import{useParams as fr}from"next/navigation";import{CheckIcon as gr}from"@heroicons/react/24/outline";import De,{useEffect as mr,useState as cr}from"react";var ur=({product:r,variant:e,onChangeVariantIdx:t,className:n,Select:o})=>{let[i,s]=cr(),{productAttributes:l}=G(),{findAttributeLabel:a}=se({productAttributes:l}),d=y=>a(r?.variants.find(v=>v.sku===y)?.attributes),p=y=>{let v=r?.variants.findIndex(h=>h.sku===y);t(v),s(r?.variants[v])};return mr(()=>{e&&s(e)},[e]),De.createElement("div",null,De.createElement("p",{className:"p-4 text-14 font-semibold leading-loose"},r.name),De.createElement(o,{onChange:y=>p(y),className:n,defaultValue:i?.sku,options:r?.variants.map(y=>({value:y.sku,name:d(y.sku)}))}))},Xe=ur;var yr=({product:r,className:e,children:t,Button:n,Select:o,translatedTexts:i})=>{let[s,l]=me(0),[a,d]=me(!0),[p,y]=me([]),[v,h]=me(),[g,m]=me(),{configurableComponents:c,setSelectedVariants:u,productAttributes:b}=G(),{findAttributeLabel:x}=se({productAttributes:b}),{locale:w}=fr(),D=(C,N)=>{y(F=>F.map((I,A)=>A!==N?I:{...I,tempVariant:I.variants?.[C]}))},O=C=>{l(C+1),y(p.map((N,F)=>C!==F?N:{...N,selectedVariant:{...N.tempVariant}}))},E=C=>{y(p.map((N,F)=>s!==F?N:{...N,tempVariant:void 0})),l(C)};return Ye(()=>{if(p.length){let C=p.reduce((F,I)=>M.addCurrency(F,I.tempVariant?.price),{centAmount:0,currencyCode:r.currency}),N=p.reduce((F,I)=>M.addCurrency(F,I.selectedVariant?.price),{centAmount:0,currencyCode:r.currency});d(p.some(F=>!F.selectedVariant)),h(M.subtractCurrency(C,g||{centAmount:0,currencyCode:r.currency})),m(N),u(p.map(F=>F.selectedVariant))}},[p]),Ye(()=>{c?.length&&y(c)},[c]),c?.length?T.createElement(T.Fragment,null,T.createElement("style",null,`
        .tab-panels--selected {
          margin-top: -1px;
        }
        .tab-button--selected {
          margin-bottom: -1px;
        }
      `),T.createElement("div",{className:e},p.map((C,N)=>T.createElement(T.Fragment,null,T.createElement("input",{type:"radio",name:"tabset",className:"hidden",id:`tab${N}`,checked:N===s,onChange:()=>s>N&&E(N)}),T.createElement("label",{className:`relative inline-block cursor-pointer whitespace-nowrap border-neutral-300 bg-white px-4 py-4 text-12 ${s===N&&"z-10 border-t border-x font-bold"} ${p.length!==s&&"tab-button--selected"}`,htmlFor:`tab${N}`},T.createElement("span",{className:"flex items-center gap-2"},C.name," ",s>N&&T.createElement(gr,{className:"h-4 w-4 text-primary"}))))),T.createElement("div",{className:`tab-panels relative ${p.length!==s&&"tab-panels--selected"}`},p.map((C,N)=>T.createElement("article",{className:`border border-neutral-300 ${N===s?"block":"hidden"}`,key:C.productId},T.createElement(Xe,{className:"p-4",product:C,onChangeVariantIdx:F=>D(F,N),variant:C.tempVariant,Select:o}),T.createElement("div",{className:"flex justify-center p-4"},T.createElement(n,{variant:"primary",size:"full",onClick:()=>O(N),type:"button"},`${i?.next} ${v?.centAmount&&v?.centAmount>=0?"+":""}${M.formatForCurrency(v||0,w)}`)))),p.length===s&&T.createElement("article",{className:"border-accent-400 max-h-[350px] border p-4"},T.createElement("span",{className:"text-14 font-semibold"},i?.summary),T.createElement("ul",null,p.map(C=>T.createElement("li",{key:C.productId},T.createElement("span",{className:"text-14 font-bold"},C.name,": "),T.createElement("span",{className:"text-12"},x(C?.selectedVariant?.attributes))))),T.createElement("div",{className:"mt-4"},T.createElement("span",{className:"text-14"},i?.total),T.createElement("p",{className:"text-16"},`${M.formatForCurrency(r?.price*100,w,r?.currency)} + ${M.formatForCurrency(g||0)}`)),T.createElement("button",{className:"text-accent-400 mt-8 underline",onClick:()=>E(0),type:"button"},i?.back)),p.length!==s&&T.createElement("div",{className:"mt-4"},T.createElement("span",{className:"text-14"},i?.total),T.createElement("p",{className:"text-16"},`${M.formatForCurrency(r?.price*100,w,r?.currency)} + ${M.formatForCurrency(g||0,w)}`)))),t({isDisabled:a})):t({isDisabled:!1})},Ze=yr;import{useCallback as br}from"react";var vr=(r,e,t,n)=>{let{selectedVariants:o}=G();return{addComponents:br(async s=>{if(o.length===0)return Promise.resolve({});let l={lineItems:s.map(({sku:d,count:p})=>({variant:{sku:d},count:p})),businessUnitKey:t,configurableComponents:o?.filter(Boolean)?.map(d=>({variant:d,count:1}))},a=await r.callAction({actionName:"cart/addComponentsToCart",payload:l,query:{businessUnitKey:t,storeKey:n}});return a.isError||e(a.data,{revalidate:!1}),a.isError?{success:!1,message:a.error.message}:{...a.data,success:!0}},[o,t,n])}},Re=vr;var xr={BundledItems:Ge,ConfigurableComponents:Ze},Cr={ConfigurableComponentsProvider:Ke,useConfigurableComponentsContext:G,BundledItemsProvider:Qe,useBundledItemsContext:ne},hr={useChildComponents:Je,useComponentsCart:Re};var Be={};ge(Be,{COMPONENTS:()=>Lr,PROVIDERS:()=>Er,hooks:()=>Vr});import q,{Fragment as Dr}from"react";import{Popover as Ie,Transition as kr}from"@headlessui/react";import{ChevronDownIcon as Ir,ChevronUpIcon as Br,CheckIcon as Tr}from"@heroicons/react/24/outline";import wr,{createContext as Nr,useCallback as Ar,useContext as Sr,useEffect as Pr,useState as et}from"react";var tt=Nr({setSuperuserCarts:()=>{},superuserStatus:{carts:[],isSuperuser:!1}}),Fr=({children:r,sdk:e})=>{let[t,n]=et(),[o,i]=et(!1),s=Ar(async()=>{let l=await e.callAction({actionName:"account/getSuperuser"});l.isError||(n(l.data.carts),i(!!l.data.isSuperuser))},[]);return Pr(()=>{s()},[]),wr.createElement(tt.Provider,{value:{setSuperuserCarts:n,superuserStatus:{carts:t??[],isSuperuser:o}}},r)},rt=Fr,X=()=>Sr(tt);var $r=({setCart:r,createSuperuserCart:e,cartId:t,className:n,associates:o,translate:i})=>{let{superuserStatus:s}=X(),l=async(d,p)=>{d?.preventDefault?.(),d?.stopPropagation?.();let y=s?.carts?.find(h=>h.id===p),v=o?.find(h=>h.accountId===y?.customerId);await r(p,v?.email)},a=async()=>{await e()};return s?.isSuperuser?q.createElement(Ie,{className:`relative ${n}`},({open:d})=>q.createElement(q.Fragment,null,q.createElement(Ie.Button,{className:`
                      ${d?"":"text-opacity-90"}
                      text-accent-400 flex flex-row text-sm font-medium focus:outline-none`},!d&&q.createElement(Ir,{className:"mt-1 h-4 w-4"}),d&&q.createElement(Br,{className:"mt-1 h-4 w-4"})),q.createElement(kr,{as:Dr,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1"},q.createElement(Ie.Panel,{className:"dark:bg-primary-400 dark:shadow-3xl absolute right-0 top-6 z-50 mr-8 mt-2 max-h-[300px] w-72 origin-top-right overflow-scroll rounded-sm bg-white p-2 shadow-sm ring-1 ring-black/5 focus:outline-none"},s?.carts?.map(p=>q.createElement("button",{type:"button",className:`inline w-full p-2 text-left text-xs hover:bg-neutral-300 ${p.id===t?"bg-neutral-300":""}`,disabled:p.id===t,key:p.id,onClick:y=>l(y,p.id)},`${i("common.cart")} ${p.origin==="Quote"?` - ${i("cart.createdFromAQuote")} `:""} ${p.origin==="Merchant"?` - ${i("cart.createdByAMerchant")} `:""}`,`${i("cart.with")} ${M.formatForCurrency(p.totalPrice)||0} ${i("cart.total.price")}`,p.createdBy?.associate?.obj?.firstName&&p.createdBy?.associate?.obj?.lastName&&q.createElement(q.Fragment,null,q.createElement("span",{className:"font-semibold"},` ${i("cart.name")}: `),`${p.createdBy?.associate?.obj?.firstName} ${p.createdBy?.associate?.obj?.lastName}`),p.createdBy?.associate?.obj?.email&&q.createElement(q.Fragment,null,q.createElement("span",{className:"font-semibold"},` ${i("cart.email")}: `),p.createdBy?.associate?.obj?.email),p.id===t&&q.createElement(Tr,{className:"ml-2 inline h-4 w-4"}))),q.createElement("button",{type:"button",className:"inline w-full p-2 text-left text-xs hover:bg-neutral-300",onClick:a},i("cart.createNewCart")))))):null},ot=$r;import ce from"react";import{CheckIcon as jr}from"@heroicons/react/24/outline";var Or=({activeBusinessUnit:r,className:e,accountId:t,cartAccountId:n,Dropdown:o,translate:i,reassignCart:s})=>{let{superuserStatus:l}=X();return!l?.isSuperuser||r?.associates?.length===0?null:ce.createElement(o,{onChange:a=>s(a?.accountId,a?.email),className:e},ce.createElement(o.Button,null,i("cart.superuser.reassign.cart")),ce.createElement(o.Options,null,r?.associates?.filter(a=>a.accountId!==t).map(a=>ce.createElement(o.Option,{key:a.accountId,value:a},`${a.firstName||""} ${a.lastName||""} ${a.roles?.length&&` (${a.roles.map(d=>d.key).join(", ")})`}`,n===a.accountId&&ce.createElement(jr,{className:"ml-2 inline h-4 w-4"})))))},nt=Or;var Mr=(r,e)=>{let{setSuperuserCarts:t}=X(),n=async(l,a)=>{let d=await r.callAction({actionName:`cart/setCart?id=${l}`,payload:{email:a}});return d.isError||e(d.data,{revalidate:!1}),window.location.replace("/"),d.isError?{}:d.data},o=async()=>{let l=await r.callAction({actionName:"cart/createSuperuserCart"});return s(),l.isError||e(l.data,{revalidate:!1}),l.isError?{}:l.data},i=async(l,a)=>{let d=await r.callAction({actionName:"cart/reassignCart",payload:{accountId:l,email:a}});return d.isError||e(d.data,{revalidate:!1}),d.isError?{}:d.data},s=async()=>{let l=await r.callAction({actionName:"cart/getAllSuperuserCartsInStore"});l.isError||t(l.data)};return{setCart:n,createSuperuserCart:o,reassignCart:i}},st=Mr;var Lr={CartBrowser:ot,CartReassignButton:nt},Er={SuperuserProvider:rt,useSuperuserContext:X},Vr={useSuperuserCarts:st};var Me={};ge(Me,{COMPONENTS:()=>Wo,HOOKS:()=>Ho});import oo,{useEffect as no,useState as so}from"react";var K=(r,e,t)=>({getApprovalFlows:async({limit:g,cursor:m,ids:c,states:u,createdFrom:b,createdTo:x}={})=>{let w=await r.callAction({actionName:"approval/getApprovalFlows",query:{...g?{limit:g}:{},...m?{cursor:m}:{},...c?{flowIds:c}:{},...u?{flowStates:u}:{},...b?{createdFrom:b}:{},...x?{createdTo:x}:{},...e?{businessUnitKey:e}:{},...t?{storeKey:t}:{}}});if(!w.isError)return w.data;throw w.error},approveFlow:async g=>{let m=await r.callAction({actionName:"approval/approveFlow",query:{approvalFlowId:g,businessUnitKey:e,storeKey:t}});if(!m.isError)return m.data;throw m.error},rejectFlow:async(g,m)=>{let c=await r.callAction({actionName:"approval/rejectFlow",query:{approvalFlowId:g,businessUnitKey:e,storeKey:t},payload:{reason:m}});if(!c.isError)return c.data;throw c.error},getApprovalFlowByOrderId:async g=>{let m=await r.callAction({actionName:"approval/getApprovalFlowByOrderId",query:{businessUnitKey:e,storeKey:t,orderId:g}});if(!m.isError)return m.data;throw m.error},getApprovalFlowById:async g=>{let m=await r.callAction({actionName:"approval/getApprovalFlow",query:{businessUnitKey:e,storeKey:t,approvalFlowId:g}});if(!m.isError)return m.data;throw m.error},getApprovalRules:async({limit:g,cursor:m,ids:c,states:u,createdFrom:b,createdTo:x,predicate:w})=>{let D=await r.callAction({actionName:"approval/getApprovalRules",query:{...g?{limit:g}:{},...m?{cursor:m}:{},...c?{ruleIds:c}:{},...u?{ruleStates:u}:{},...w?{predicate:w}:{},...b?{createdFrom:b}:{},...x?{createdTo:x}:{},...e?{businessUnitKey:e}:{},...t?{storeKey:t}:{}}});if(!D.isError)return D.data;throw D.error},activateRule:async g=>{let m=await r.callAction({actionName:"approval/activateApprovalRule",query:{businessUnitKey:e,storeKey:t,approvalRuleId:g}});if(!m.isError)return m.data;throw m.error},deactivateRule:async g=>{let m=await r.callAction({actionName:"approval/deactivateApprovalRule",query:{businessUnitKey:e,storeKey:t,approvalRuleId:g}});if(!m.isError)return m.data;throw m.error},createRule:async g=>{let m=await r.callAction({actionName:"approval/createApprovalRule",query:{businessUnitKey:e,storeKey:t},payload:g});if(!m.isError)return m.data;throw m.error},duplicateRule:async(g,m)=>{let c=await r.callAction({actionName:"approval/duplicateApprovalRule",query:{businessUnitKey:e,storeKey:t,approvalRuleId:g},payload:{businessUnitKeys:m}});if(!c.isError)return c.data;throw c.error},updateRule:async(g,m)=>{let c=await r.callAction({actionName:"approval/updateApprovalRule",query:{businessUnitKey:e,storeKey:t,approvalRuleId:g},payload:m});if(!c.isError)return c.data;throw c.error}});import ue from"react";import $ from"react";import{AdjustmentsHorizontalIcon as zr}from"@heroicons/react/24/outline";import{useCallback as Te,useState as Ur}from"react";var qr=({openDelay:r,closeDelay:e,defaultIsOpen:t=!1}={})=>{let[n,o]=Ur(t),i=Te(()=>{r?setTimeout(()=>o(!0),r):o(!0)},[r]),s=Te(()=>{e?setTimeout(()=>o(!1),e):o(!1)},[e]),l=Te(()=>{n?s():i()},[i,s,n]);return{isOpen:n,onOpen:i,onClose:s,onToggle:l}},$e=qr;var Wr=({flows:r,sortOptions:e,filters:t,onSortBy:n,onSearch:o,onClearRefinements:i,statusOptions:s,onStatusRefine:l,onCreationDateRefine:a,translate:d,components:p})=>{let{isOpen:y,onOpen:v,onClose:h}=$e(),{isOpen:g,onClose:m,onToggle:c}=$e(),u=[{title:"product.sortBy",Component:$.createElement("div",{className:"flex flex-col gap-7"},(e??[]).map(({name:b,value:x})=>$.createElement(p.Radio,{key:x,label:b,checked:x===t?.sort,onSelected:()=>n?.(x)})))},{title:"dashboard.quote.search",Component:$.createElement(p.SearchInput,{searchValue:t?.search??"",variant:"sm",placeholder:`${d?.("dashboard.search.for.flows")}...`,handleOnChange:b=>o?.(b)})},{title:"dashboard.order.status",Component:$.createElement("div",{className:"flex flex-col gap-7"},(s??[]).map(({name:b,value:x})=>$.createElement(p.Checkbox,{key:x,label:b,checked:t?.status?.includes(x),onChecked:w=>l?.(w?x:"")})))},{title:"dashboard.creation.date",Component:$.createElement("div",null,$.createElement("div",{onClick:c,className:"rounded-md border border-gray-300 px-3 py-2 text-14 text-gray-600"},t?.createdFrom||t?.createdTo?`${t.createdFrom?new Date(t.createdFrom).toLocaleDateString():""} : ${t.createdTo?new Date(t.createdTo).toLocaleDateString():""}`:"dd/mm/yy"),g&&$.createElement("div",null,$.createElement(p.DatePicker,{mode:"range",selected:{from:t?.createdFrom?new Date(t?.createdFrom):void 0,to:t?.createdTo?new Date(t?.createdTo):void 0},onSelect:b=>a?.({from:b?.from,to:b?.to})}),$.createElement("div",{className:"mt-2 flex items-center justify-end gap-8 pr-8"},$.createElement("span",{className:"text-14 font-medium uppercase text-primary",onClick:m},d?.("common.cancel")),$.createElement("span",{className:"text-14 font-medium uppercase text-primary",onClick:()=>{m()}},d?.("common.save")))))}];return $.createElement("div",{className:"lg:hidden"},$.createElement("button",{className:"flex w-full cursor-pointer items-center justify-center gap-2 rounded-md border border-gray-300 p-2 text-14 text-gray-600 transition hover:bg-gray-50 md:w-fit md:grow-0",onClick:v},$.createElement("span",null,d?.("product.sortAndFilter")),$.createElement(zr,{width:20})),$.createElement(p.Drawer,{isOpen:y,onClose:h,direction:"left",headline:d?.("product.sortAndFilter"),className:"h-[100vh] w-[90vw] max-w-[350px]",headerClassName:"border-y border-neutral-400"},$.createElement("div",{className:"flex h-full flex-col"},$.createElement("div",{className:"grow overflow-y-auto px-4 lg:px-5"},u.map(({title:b,Component:x},w)=>$.createElement("div",{key:w,className:"border-b border-neutral-400"},$.createElement(p.Accordion,{className:"border-none"},$.createElement(p.Accordion.Button,{className:"py-5",defaultSpacing:!1},$.createElement("span",{className:"text-14 font-bold"},d?.(b))),$.createElement(p.Accordion.Panel,{defaultSpacing:!1,className:"pb-6"},x))))),$.createElement("div",{className:"flex items-center gap-3 border-t border-neutral-400 p-4 lg:p-5"},$.createElement(p.Button,{variant:"secondary",className:"flex-1",onClick:()=>{i?.(),h()}},d?.("product.clear.all")),$.createElement(p.Button,{variant:"primary",className:"flex-1",onClick:h},d?.("common.view")," (",r?.length,")")))))},at=Wr;import _ from"react";var Hr=({filters:r,onSearch:e,statusOptions:t,onStatusRefine:n,onCreationDateRefine:o,translate:i,components:s})=>{let l=[{title:"flows.label",Component:_.createElement(s.SearchInput,{className:"h-[38px] w-[360px]",searchValue:r?.search??"",variant:"xs",placeholder:`${i?.("dashboard.search.for.flows")}...`,handleOnChange:a=>e?.(a)})},{title:"common.status",Component:_.createElement(s.RefinementDropdown,{size:"lg",className:"w-[200px]",options:(t??[]).map(({name:a,value:d,count:p})=>({name:a,value:d,count:p,selected:!!r?.status?.includes(d),onSelected:()=>n?.(d)}))},i?.("common.select"))},{title:"dashboard.creation.date",Component:_.createElement(s.Dropdown,{size:"lg",className:"w-[200px]"},_.createElement(s.Dropdown.Button,null,i?.("common.select")),_.createElement(s.Dropdown.Options,{className:"max-h-[unset] w-max"},_.createElement(s.DatePicker,{mode:"range",selected:{from:r?.createdFrom?new Date(r?.createdFrom):void 0,to:r?.createdTo?new Date(r?.createdTo):void 0},onSelect:a=>o?.({from:a?.from,to:a?.to})})))}];return _.createElement("div",{className:"hidden gap-3 lg:flex"},l.map(({title:a,Component:d},p)=>_.createElement("div",{key:p},_.createElement("h5",{className:"text-14 text-gray-700"},i?.(a)),_.createElement("div",{className:"mt-2"},d))))},it=Hr;import Y,{useMemo as Kr}from"react";import{XMarkIcon as _r}from"@heroicons/react/24/solid";var Qr=({filters:r,onClearRefinements:e,onStatusRefine:t,onCreationDateRefine:n,translate:o})=>{let i=Kr(()=>{let s=[];return r&&(r.status?.length&&s.push(...r.status.map(l=>({name:o?.(`dashbaord.flows.status.${l.toLowerCase()}`)||l,onRefine:()=>t?.(l)}))),(r.createdFrom||r.createdTo)&&s.push({name:`${r.createdFrom?new Date(r.createdFrom).toLocaleDateString():""} : ${r.createdTo?new Date(r.createdTo).toLocaleDateString():""}`,onRefine:()=>n?.({from:void 0,to:void 0})})),s},[r,t,n,o]);return!r?.status?.length&&!r?.createdFrom&&!r?.createdTo?Y.createElement(Y.Fragment,null):Y.createElement("div",{className:"mt-5 lg:mt-8"},Y.createElement("div",{className:"flex flex-wrap gap-3"},Y.createElement("div",{className:"cursor-pointer rounded-md border border-gray-300 px-2 py-[6px] text-14 leading-[20px] text-gray-700",onClick:e},o?.("dashboard.clear.all")),i.map(({name:s,onRefine:l})=>Y.createElement("div",{key:s,className:"flex items-center gap-2 rounded-md border border-neutral-200 bg-neutral-200 px-2 py-[6px] text-14 leading-[20px] text-gray-700"},Y.createElement("span",null,s),Y.createElement(_r,{className:"cursor-pointer text-gray-700",width:16,height:16,onClick:l})))))},lt=Qr;import L from"react";import Jr from"react";var Gr=({status:r,translate:e,components:t})=>{let n={Pending:"warning",Approved:"primary",Rejected:"danger"};return Jr.createElement(t.Tag,{className:"capitalize",variant:n[r]},e?.(`dashboard.flows.status.${r.toLowerCase()}`))},ve=Gr;var Xr=({flows:r,totalItems:e=0,page:t=1,onPageChange:n,onRowsPerPageChange:o,translate:i,components:s,limit:l=25})=>{let a=s?.Table;return L.createElement(a,{className:"mt-8"},L.createElement(a.Container,{className:"table-fixed rounded-md"},L.createElement(a.Head,{className:"border-b text-12 font-bold"},L.createElement(a.Cell,null,i?.("common.status")),L.createElement(a.Cell,null,i?.("common.id")),L.createElement(a.Cell,null,i?.("common.date")),L.createElement(a.Cell,null,i?.("common.order.number")),L.createElement(a.Cell,{isButtonsHead:!0})),L.createElement(a.Body,null,(r??[]).map(({id:d,status:p,order:y,createdAt:v})=>L.createElement(a.Row,{key:d},L.createElement(a.Cell,null,L.createElement("div",{className:"flex items-center justify-between gap-2"},L.createElement(ve,{status:p,components:s,translate:i}))),L.createElement(a.Cell,null,L.createElement("span",{className:"block max-w-full truncate"},d)),L.createElement(a.Cell,null,new Date(v).toLocaleDateString()),L.createElement(a.Cell,null,y.orderNumber),L.createElement(a.Cell,{isButtonsCell:!0},L.createElement("div",{className:"flex justify-end"},L.createElement(s.Link,{href:`/approval-flow/${d.replace(/\s+/g,"-")}`,underlineOnHover:!1},L.createElement(s.Button,{variant:"secondary"},i?.("common.view"))))))))),L.createElement(a.Pagination,{page:t,limit:l,totalItems:e,onNext:()=>n?.(t+1),onPrevious:()=>n?.(t-1),onRowsPerPageChange:o}))},dt=Xr;var Yr=({translate:r,components:e,flows:t,onClearRefinements:n,onStatusRefine:o,onCreationDateRefine:i,onSearch:s,sortOptions:l,onSortBy:a,filters:d,statusOptions:p,totalItems:y,page:v,onPageChange:h,onRowsPerPageChange:g,limit:m})=>{let c={flows:t,onClearRefinements:n,onSearch:s,onStatusRefine:o,onCreationDateRefine:i,sortOptions:l,onSortBy:a,filters:d,statusOptions:p,translate:r,components:e},u={translate:r,onClearRefinements:n,filters:d,onSearch:s,onStatusRefine:o,onCreationDateRefine:i},b={flows:t,totalItems:y,page:v,limit:m,components:e,onPageChange:h,onRowsPerPageChange:g,translate:r};return ue.createElement("div",{className:"w-full"},ue.createElement(at,{...c}),ue.createElement(it,{...c}),ue.createElement(lt,{...u}),ue.createElement(dt,{...b}))},pt=Yr;import{useCallback as xe,useMemo as eo,useState as fe}from"react";import{useEffect as Zr,useState as Rr}from"react";function mt(r,e){let[t,n]=Rr(r);return Zr(()=>{let o=setTimeout(()=>n(r),e||500);return()=>{clearTimeout(o)}},[r,e]),t}var to=()=>{let[r,e]=fe(25),[t,n]=fe("offset:0"),[o,i]=fe([]),[s,l]=fe(""),[a,d]=fe({from:void 0,to:void 0}),p=mt(s),y=Math.floor(+t.split(":")[1]/r)+1,v=xe(u=>i([...o,u]),[o]),h=xe(u=>i(o.filter(b=>b!==u)),[o]),g=xe(u=>{let[b,x,w]=[u.getDate().toString().padStart(2,"0"),(u.getMonth()+1).toString().padStart(2,"0"),u.getFullYear()];return`${w}-${x}-${b}`},[]),m=eo(()=>{let u={};return a.from&&(u.from=`${g(a.from)}T00:00:00.000Z`),a.to&&(u.to=`${g(a.to)}T23:59:59.999Z`),u},[a,g]),c=xe(()=>{e(25),i([]),l(""),d({from:void 0,to:void 0})},[]);return{limit:r,page:y,setLimit:e,cursor:t,setCursor:n,states:o,addState:v,removeState:h,setStates:i,search:s,debouncedSearch:p,setSearch:l,date:a,ISODate:m,onCreationDateRefine:d,clearRefinements:c}},Ce=to;var ro=r=>({flowStatusOptions:(n=>n.map(({name:o,value:i})=>({name:r(`dashboard.flows.status.${o.toLowerCase()}`),value:i})))([{name:"Pending",value:"Pending"},{name:"Approved",value:"Approved"},{name:"Rejected",value:"Rejected"}])}),ct=ro;var ao=({businessUnitKey:r,storeKey:e,sdk:t,components:n,translate:o})=>{let{getApprovalFlows:i}=K(t,r,e),{page:s,limit:l,setLimit:a,cursor:d,setCursor:p,clearRefinements:y,states:v,addState:h,removeState:g,search:m,debouncedSearch:c,setSearch:u,date:b,ISODate:x,onCreationDateRefine:w}=Ce(),[D,O]=so([]),{flowStatusOptions:E}=ct(o),C=D.previousCursor,N=D.nextCursor,F=D.total??0;return no(()=>{r&&(async()=>{let I=await i({limit:l,cursor:d,...v.length?{states:v}:{},...c?{ids:[c.trim()]}:{},createdFrom:x.from,createdTo:x.to});O(I)})()},[r,l,d,v,c,x.from,x.to]),r?oo.createElement(pt,{translate:o,components:n,flows:D.items||[],filters:{search:m,status:v,createdFrom:b.from?.toString(),createdTo:b.to?.toString()},sortOptions:[],statusOptions:E,onSearch:I=>u(I),onStatusRefine:I=>{v.includes(I)?g(I):h(I)},onClearRefinements:y,onCreationDateRefine:w,page:s,totalItems:F,limit:l,onPageChange:I=>{let A=I>s;A&&N?p(N):!A&&C&&p(C)},onRowsPerPageChange:I=>a(+I)}):null},ut=ao;import bo,{useEffect as vo,useState as xo}from"react";import ie,{useMemo as go}from"react";import H from"react";var io=({filters:r,onSearch:e,statusOptions:t,onStatusRefine:n,onCreationDateRefine:o,translate:i,components:s,children:l})=>{let a=[{title:"dashboard.rules.search.label",Component:H.createElement(s.SearchInput,{className:"h-[38px] w-[360px]",searchValue:r?.search??"",variant:"xs",placeholder:`${i?.("dashboard.search.for.rules")}...`,handleOnChange:d=>e?.(d)})},{title:"common.status",Component:H.createElement(s.RefinementDropdown,{size:"lg",className:"w-[200px]",options:(t??[]).map(({name:d,value:p,count:y})=>({name:d,value:p,count:y,selected:!!r?.status?.includes(p),onSelected:()=>n?.(p)}))},i?.("common.select"))},{title:"dashboard.creation.date",Component:H.createElement(s.Dropdown,{size:"lg",className:"w-[200px]"},H.createElement(s.Dropdown.Button,null,i?.("common.select")),H.createElement(s.Dropdown.Options,{className:"max-h-[unset] w-max"},H.createElement(s.DatePicker,{mode:"range",selected:{from:r?.createdFrom?new Date(r?.createdFrom):void 0,to:r?.createdTo?new Date(r?.createdTo):void 0},onSelect:d=>o?.({from:d?.from,to:d?.to})})))}];return H.createElement("div",{className:"hidden items-end justify-between lg:flex"},H.createElement("div",{className:"hidden gap-3 lg:flex"},a.map(({title:d,Component:p},y)=>H.createElement("div",{key:y},H.createElement("h5",{className:"text-14 text-gray-700"},i?.(d)),H.createElement("div",{className:"mt-2"},p)))),l)},ft=io;import Z,{useMemo as lo}from"react";import{XMarkIcon as po}from"@heroicons/react/24/solid";var mo=({filters:r,onClearRefinements:e,onStatusRefine:t,onCreationDateRefine:n,translate:o})=>{let i=lo(()=>{let s=[];return r&&(r.status?.length&&s.push(...r.status.map(l=>({name:o?.(`dashboard.rules.status.${l.toLowerCase()}`)||l,onRefine:()=>t?.(l)}))),(r.createdFrom||r.createdTo)&&s.push({name:`${r.createdFrom?new Date(r.createdFrom).toLocaleDateString():""} : ${r.createdTo?new Date(r.createdTo).toLocaleDateString():""}`,onRefine:()=>n?.({from:void 0,to:void 0})})),s},[r,t,n,o]);return!r?.status?.length&&!r?.createdFrom&&!r?.createdTo?Z.createElement(Z.Fragment,null):Z.createElement("div",{className:"mt-5 lg:mt-8"},Z.createElement("div",{className:"flex flex-wrap gap-3"},Z.createElement("div",{className:"cursor-pointer rounded-md border border-gray-300 px-2 py-[6px] text-14 leading-[20px] text-gray-700",onClick:e},o?.("dashboard.clear.all")),i.map(({name:s,onRefine:l})=>Z.createElement("div",{key:s,className:"flex items-center gap-2 rounded-md border border-neutral-200 bg-neutral-200 px-2 py-[6px] text-14 leading-[20px] text-gray-700"},Z.createElement("span",null,s),Z.createElement(po,{className:"cursor-pointer text-gray-700",width:16,height:16,onClick:l})))))},gt=mo;import k from"react";import co from"react";var uo=({status:r,translate:e,components:t})=>{let n={Inactive:"warning",Active:"primary"};return co.createElement(t.Tag,{className:"capitalize",variant:n[r]},e?.(`dashboard.rules.status.${r.toLowerCase()}`))},yt=uo;var fo=({rules:r,totalItems:e=0,page:t=1,onPageChange:n,onRowsPerPageChange:o,translate:i,components:s,limit:l=25})=>{let a=s?.Table;return k.createElement(a,{className:"mt-8"},k.createElement(a.Container,{className:"table-fixed rounded-md"},k.createElement(a.Head,{className:"border-b text-12 font-bold"},k.createElement(a.Cell,null,i?.("common.status")),k.createElement(a.Cell,null,i?.("common.name")),k.createElement(a.Cell,null,i?.("common.description")),k.createElement(a.Cell,null,i?.("common.id")),k.createElement(a.Cell,null,i?.("dashboard.rules.createdAt")),k.createElement(a.Cell,null,i?.("dashboard.rules.predicate")),k.createElement(a.Cell,{isButtonsHead:!0})),k.createElement(a.Body,null,(r??[]).map(({name:d,description:p,id:y,status:v,createdAt:h,predicate:g})=>k.createElement(a.Row,{key:y},k.createElement(a.Cell,null,k.createElement("div",{className:"flex items-center justify-between gap-2"},k.createElement("span",{className:"block max-w-full truncate"},k.createElement(yt,{status:v,translate:i,components:s})))),k.createElement(a.Cell,null,k.createElement("span",{className:"block max-w-full"},d)),k.createElement(a.Cell,null,k.createElement("span",{className:"block max-w-full truncate"},p)),k.createElement(a.Cell,null,k.createElement("span",{className:"block max-w-full truncate"},y)),k.createElement(a.Cell,null,new Date(h).toLocaleDateString()),k.createElement(a.Cell,null,g),k.createElement(a.Cell,{isButtonsCell:!0},k.createElement("div",{className:"flex justify-end"},k.createElement(s.Link,{href:`/approval-rule/${y.replace(/\s+/g,"-")}`,underlineOnHover:!1},k.createElement(s.Button,{variant:"secondary"},i?.("common.view"))))))))),k.createElement(a.Pagination,{page:t,limit:l,totalItems:e,onNext:()=>n?.(t+1),onPrevious:()=>n?.(t-1),onRowsPerPageChange:o}))},bt=fo;var yo=({translate:r,permissions:e,components:t,rules:n,onClearRefinements:o,onStatusRefine:i,onCreationDateRefine:s,onSearch:l,sortOptions:a,onSortBy:d,filters:p,statusOptions:y,totalItems:v,page:h,onPageChange:g,onRowsPerPageChange:m,limit:c})=>{let u={rules:n,onClearRefinements:o,onSearch:l,onStatusRefine:i,onCreationDateRefine:s,sortOptions:a,onSortBy:d,filters:p,statusOptions:y,translate:r,components:t},b={translate:r,onClearRefinements:o,filters:p,onSearch:l,onStatusRefine:i,onCreationDateRefine:s},x={rules:n,totalItems:v,page:h,limit:c,components:t,onPageChange:g,onRowsPerPageChange:m,translate:r},w=go(()=>!e?.UpdateApprovalRules,[e]);return ie.createElement("div",{className:"w-full"},ie.createElement(ft,{...u},ie.createElement(t.Link,{href:w?"":"/create-approval-rule",className:"block w-full md:w-fit",underlineOnHover:!1},ie.createElement(t.Button,{size:"m",className:"w-full px-6",disabled:w},r("dashboard.new.rule")))),ie.createElement(gt,{...b}),ie.createElement(bt,{...x}))},vt=yo;var Co=({businessUnitKey:r,storeKey:e,sdk:t,components:n,permissions:o,translate:i})=>{let{getApprovalRules:s}=K(t,r,e),{page:l,limit:a,setLimit:d,cursor:p,setCursor:y,clearRefinements:v,states:h,addState:g,removeState:m,search:c,debouncedSearch:u,setSearch:b,date:x,ISODate:w,onCreationDateRefine:D}=Ce(),[O,E]=xo([]),C=[{name:i("dashboard.rules.status.active"),value:"Active"},{name:i("dashboard.rules.status.inactive"),value:"Inactive"}],N=O.previousCursor,F=O.nextCursor,I=O.total??0;return vo(()=>{r&&(async()=>{let A=await s({limit:a,cursor:p,...h.length?{states:h}:{},...u?{predicate:u.trim()}:{},createdFrom:w.from,createdTo:w.to});E(A)})()},[r,a,p,h,u,w.from,w.to]),r?bo.createElement(vt,{translate:i,components:n,permissions:o,rules:O.items||[],filters:{search:c,status:h,createdFrom:x.from?.toString(),createdTo:x.to?.toString()},sortOptions:[],statusOptions:C,onSearch:A=>b(A),onStatusRefine:A=>{h.includes(A)?m(A):g(A)},onClearRefinements:v,onCreationDateRefine:D,page:l,totalItems:I,limit:a,onPageChange:A=>{let B=A>l;B&&F?y(F):!B&&N&&y(N)},onRowsPerPageChange:A=>d(+A)}):null},xt=Co;import f,{useEffect as Ct,useMemo as je,useState as le}from"react";import ho from"next/dynamic";import{useParams as wo}from"next/navigation";var No=ho(()=>import("./approvers-preview-EKJNYZ2M.js"),{ssr:!1}),Oe=r=>{let e=r instanceof Date?r:new Date(r),[t,n,o]=[e.getDate().toString().padStart(2,"0"),(e.getMonth()+1).toString().padStart(2,"0"),e.getFullYear().toString()];return`${t}-${n}-${o}`},Ao=({sdk:r,activeBusinessUnit:e,storeKey:t,flow:n,translate:o,calculateTransaction:i,components:s,accountId:l,permissions:a})=>{let{approveFlow:d,rejectFlow:p}=K(r,e.key,t),[y,v]=le(!1),[h,g]=le(""),[m,c]=le([]),[u,b]=le([]),[x,w]=le([]),[D,O]=le({approve:!1,reject:!1}),{locale:E}=wo(),C=je(()=>!a?.UpdateApprovalFlows,[a]),N=async()=>{O({...D,approve:!0}),await d(n.id),O({...D,approve:!1})},F=async()=>{O({...D,reject:!0}),await p(n.id,h),g(""),O({...D,reject:!1})},I=je(()=>m.some(B=>x.includes(B)),[m,x]),A=je(()=>{let{total:B,shipping:V,subtotal:W,tax:R,discount:re}=i(n.order);return{currency:n.order?.sum?.currencyCode??"USD",subtotal:W.centAmount*100,...W.centAmount>0?{taxCosts:R.centAmount*100}:{},...V.centAmount>0?{shippingCosts:V.centAmount*100}:{},...re.centAmount>0?{discount:re.centAmount*100}:{},total:B.centAmount*100}},[n.order]);return Ct(()=>{if(e&&l){let B=e.associates.find(V=>V.accountId===l);B&&w(B.roles?.map(V=>V.key||"")||[])}},[e,l]),Ct(()=>{n&&(c(n.approvals?.length?n.approvals.reduce((B,V)=>B.concat(V.approver.associateRoleAssignments.map(W=>W.associateRole.key)),[]):[]),b(n.rejection?n.rejection.rejecter.associateRoleAssignments.map(B=>B.associateRole.key):[]))},[n]),n?f.createElement("div",{className:""},C&&f.createElement(s.InfoBanner,{className:"mt-3"},f.createElement("b",null,o("common.view.only"))," ",o("dashboard.flow.details.view.only.desc")),f.createElement("div",{className:"flex items-center justify-between"},f.createElement("h1",{className:"py-6 text-18 font-extrabold text-gray-800 md:py-7 md:text-20 lg:py-9 lg:text-24"},o("dashboard.flow.details")),f.createElement("div",{className:"flex items-center justify-normal gap-x-3"},f.createElement(s.PreviousPageLink,null),!y&&f.createElement(f.Fragment,null,f.createElement(s.Button,{size:"s",variant:"secondary",disabled:I||n.status!=="Pending",onClick:()=>v(!0),loading:D.reject},o("dashboard.flow.details.reject")),f.createElement(s.Button,{size:"s",variant:"primary",disabled:I||n.status!=="Pending",onClick:N,loading:D.approve},o("dashboard.flow.details.approve"))),y&&f.createElement("div",{className:"flex w-full flex-col gap-2 md:w-[280px]"},f.createElement(s.Input,{name:"reason",className:"md:w-[180px]",label:o("flow.reject.reason"),required:!0,value:h,onChange:B=>g(B.target.value)}),f.createElement(s.Button,{size:"s",variant:"warning",disabled:I||n.status!=="Pending",onClick:F,loading:D.reject},o("dashboard.flow.details.reject"))))),f.createElement("h3",{className:"text-14 text-gray-600"},o("dashboard.flow.details.id"),": ",n.id),n.createdAt&&f.createElement("h3",{className:"mt-4 text-14 text-gray-600"},o("dashboard.flow.details.date"),": ",Oe(n.createdAt)),f.createElement("h3",{className:"mt-4 text-14 text-gray-600"},o("dashboard.flow.details.business_unit"),": ",n.businessUnit.key),f.createElement("h2",{className:"pt-6 text-16 font-extrabold text-gray-800 md:pt-7 md:text-18 lg:pt-9 lg:text-20"},o("dashboard.flow.details.status.title")),I&&f.createElement("h3",{className:"flex items-center gap-2 text-14 text-gray-600"},o("dashboard.flow.details.account.already.approved")),f.createElement("h3",{className:"mt-4 flex items-center gap-2 text-14 text-gray-600"},o("dashboard.flow.details.status"),":"," ",f.createElement(ve,{status:n.status,components:s,translate:o})),!!n.rejection&&f.createElement(f.Fragment,null,f.createElement("h3",{className:"mt-4 text-14 text-gray-600"},o("dashboard.flow.details.rejection.date"),": ",Oe(n.rejection.rejectedAt)),!!n.rejection.reason&&f.createElement("h3",{className:"mt-4 text-14 text-gray-600"},o("dashboard.flow.details.rejection.reason"),": ",n.rejection.reason)),!!n.approvals?.length&&n.approvals.map((B,V)=>f.createElement("h3",{className:"mt-4 text-14 text-gray-600",key:`approval-${V}`},o("dashboard.flow.details.approval.date"),": ",Oe(B.approvedAt)," ",o("dashboard.flow.details.approval.by.role"),":"," ",B.approver.associateRoleAssignments.map(W=>W.associateRole.key).join(", "))),!!n.rules.length&&n.rules.map((B,V)=>f.createElement(f.Fragment,null,f.createElement("h2",{key:`rule-${V}`,className:"pt-6 text-16 font-extrabold text-gray-800 md:pt-7 md:text-18 lg:pt-9 lg:text-20"},o("dashboard.flow.details.rule.title"),": ",B.name),f.createElement("h3",{className:"mt-4 text-14 text-gray-600",key:`rule-desc-${V}`},o("dashboard.flow.details.rule.description"),": ",B.description),f.createElement("h3",{className:"my-4 text-14 text-gray-600",key:`rule-predicate-${V}`},o("dashboard.flow.details.rule.predicate"),": ",B.predicate),f.createElement(No,{key:`rule-preview-${V}`,components:s,translate:o,isPreview:!0,tiers:B.approvers.tiers,previewApprovedRoles:m,previewRejecteddRoles:u}))),!!n.order?.lineItems?.length&&f.createElement(f.Fragment,null,f.createElement("h2",{className:"pt-6 text-16 font-extrabold text-gray-800 md:pt-7 md:text-18 lg:pt-9 lg:text-20"},o("dashboard.flow.details.order.details")),f.createElement("table",{className:"w-full"},f.createElement("thead",null,f.createElement("tr",{className:"border-b border-neutral-400 p-4 text-12 font-semibold uppercase text-gray-500"},f.createElement("th",{className:"p-4 text-left"},o("common.product")),f.createElement("th",{className:"hidden p-4 text-left md:table-cell"},o("common.sku")),f.createElement("th",{className:"hidden p-4 text-right md:table-cell"},o("common.qty")),f.createElement("th",{className:"hidden p-4 text-right lg:table-cell"},o("common.price")))),f.createElement("tbody",null,n.order.lineItems.map(({lineItemId:B,variant:V,name:W,count:R,price:re})=>f.createElement("tr",{key:B,className:"border-b border-neutral-400 p-4 text-14 text-gray-600"},f.createElement("td",{className:"p-4 text-left"},f.createElement("div",{className:"flex items-center gap-3"},f.createElement("span",{className:"relative block h-[40px] w-[40px]"},f.createElement("img",{src:V?.images?.[0],alt:W??""})),f.createElement("span",null,W))),f.createElement("td",{className:"hidden p-4 text-left md:table-cell"},V?.sku),f.createElement("td",{className:"hidden p-4 text-right md:table-cell"},R),f.createElement("td",{className:"hidden p-4 text-right lg:table-cell"},M.formatForCurrency(re??0)))))),f.createElement("div",{className:"flex justify-end border-neutral-400 pb-7 pt-6"},f.createElement("div",{className:"flex w-full flex-col gap-2 md:px-4 lg:w-[420px] lg:pl-0"},f.createElement("div",{className:"flex items-center justify-between text-14 text-gray-600"},f.createElement("span",null,o("common.subtotal")),f.createElement("span",null,M.formatForCurrency(A.subtotal,E,A.currency))),A.shippingCosts&&A.shippingCosts>0&&f.createElement("div",{className:"flex items-center justify-between text-14 text-gray-600"},f.createElement("span",null,o("common.shipping")),f.createElement("span",null,M.formatForCurrency(A.shippingCosts,E,A.currency))),A.taxCosts&&A.taxCosts>0&&f.createElement("div",{className:"flex items-center justify-between text-14 text-gray-600"},f.createElement("span",null,o("common.tax")),f.createElement("span",null,M.formatForCurrency(A.taxCosts,E,A.currency))),A.discount&&A.discount>0&&f.createElement("div",{className:"flex items-center justify-between text-14 text-gray-600"},f.createElement("span",null,o("common.discount")),f.createElement("span",null,"-",M.formatForCurrency(A.discount,E,A.currency))),f.createElement("div",{className:"flex items-center justify-between font-medium text-gray-700"},f.createElement("span",null,o("common.total"),":"),f.createElement("span",null,M.formatForCurrency(A.total,E,A.currency))))))):null},ht=Ao;import Vo from"next/dynamic";import{useRouter as Uo}from"next/navigation";import S,{useCallback as kt,useMemo as It,useState as de}from"react";import P,{useState as So,useEffect as Po}from"react";var Fo=({tiers:r,onUpdate:e,onPreview:t,associateRoles:n,translate:o,components:i})=>{let[s,l]=So(r),a=()=>{let m=[...s,{id:new Date().getTime(),and:[]}];l(m)},d=m=>{let c=s.filter(u=>u.id!==m);l(c)},p=m=>{let c=s.map(u=>u.id===m?{id:m,and:[...u.and,{id:new Date().getTime(),or:[]}]}:u);l(c)},y=(m,c)=>{let u=s.map(b=>b.id===m?{id:m,and:b.and.filter(x=>x.id!==c)}:b);l(u)},v=(m,c)=>{let u=s.map(b=>b.id===m?{id:m,and:b.and.map(x=>x.id===c?{id:c,or:[...x.or,{id:new Date().getTime(),associateRole:{typeId:"associate-role",key:n?.[0].value}}]}:x)}:b);l(u)},h=(m,c,u)=>{let b=s.map(x=>x.id===m?{id:m,and:x.and.map(w=>w.id===c?{id:c,or:w.or.filter(D=>D.id!==u)}:w)}:x);l(b)},g=(m,c,u,b)=>{let x=s.map(w=>w.id===m?{id:m,and:w.and.map(D=>D.id===c?{id:c,or:D.or.map(O=>O.id===u?{...O,associateRole:{...O.associateRole,key:b}}:O)}:D)}:w);l(x)};return Po(()=>{s&&e(s)},[s]),n?.length?P.createElement("div",{className:"border-primary-400 flex w-full flex-col items-end border p-2"},P.createElement("div",{className:"flex w-full flex-row-reverse justify-between"},P.createElement(i.Button,{type:"button",variant:"primary",size:"s",onClick:a,"data-cy":"approvers-add-tier"},P.createElement("span",{className:"text-xs"},o("dashboard.rule.details.add.tier")))),!!s.length&&P.createElement("div",{className:"mt-2 flex w-full flex-col"},s.map((m,c)=>P.createElement("div",{className:"border-primary-300 mt-2 flex w-full flex-col border p-2",key:m.id},P.createElement("div",{className:"flex w-full flex-row justify-between"},P.createElement("div",{className:"py-1/2 px-1 "},P.createElement("span",null,`Tier ${c+1}`)),P.createElement("div",{className:"flex gap-x-1"},P.createElement(i.Button,{type:"button",variant:"warning",size:"s",onClick:()=>d(m.id)},P.createElement("span",{className:"whitespace-nowrap text-xs"},o("dashboard.rule.details.remove.tier"))),P.createElement(i.Button,{type:"button",variant:"secondary",size:"s",onClick:()=>p(m.id),"data-cy":"approvers-add-and"},P.createElement("span",{className:"whitespace-nowrap text-xs"},o("dashboard.rule.details.add.and"))))),P.createElement("div",null,P.createElement("div",{className:"my-4 flex w-full grow flex-col"},P.createElement("span",{className:"py-1/2 w-fit bg-primary px-1 text-neutral-100 rounded-md"},o("dashboard.rule.details.conjunctions")),m.and.map(u=>P.createElement("div",{className:"approvers__group-item ml-6 ",key:u.id},P.createElement("div",{className:"approvers__group-wrapper border-primary-300 mb-2 flex grow flex-col border"},P.createElement("div",{className:"flex w-full grow flex-row justify-end gap-x-2 p-2"},P.createElement(i.Button,{type:"button",variant:"warning",size:"s",onClick:()=>y(m.id,u.id)},P.createElement("span",{className:"whitespace-nowrap text-xs"},o("dashboard.rule.details.remove.and"))),P.createElement(i.Button,{type:"button",variant:"secondary",size:"s",onClick:()=>v(m.id,u.id),"data-cy":"approvers-add-or"},P.createElement("span",{className:"text-xs"},o("dashboard.rule.details.add.or")))),!!u.or.length&&P.createElement("div",{className:"ml-2"},P.createElement("span",{className:"py-1/2 w-fit bg-primary px-1 text-neutral-100 rounded-md"},o("dashboard.rule.details.disjunctions")),P.createElement("div",{className:"flex flex-col pl-6"},u.or.map(b=>P.createElement("div",{key:b.id,className:"approvers__group-item flex flex-row items-center gap-x-2 pb-2"},P.createElement("span",{className:"approvers__group-wrapper"},o("dashboard.rule.details.associate.role")),P.createElement("div",{className:"w-1/2"},P.createElement(i.Select,{options:n,value:b.associateRole.key,onChange:x=>g(m.id,u.id,b.id,x)})),P.createElement(i.Button,{type:"button",variant:"warning",size:"s",onClick:()=>h(m.id,u.id,b.id)},P.createElement("span",{className:"whitespace-nowrap text-xs"},o("dashboard.rule.details.remove.or"))))))))))))))),P.createElement("div",{className:"mt-2 w-full border-t pt-2"},P.createElement(i.Button,{type:"button",variant:"primary",onClick:t,"data-cy":"approvers-preview"},o("dashboard.rule.details.preview")))):null},wt=Fo;import{useEffect as Do,useMemo as Nt,useState as ko}from"react";var Io=(r,e)=>{let[t,n]=ko({currencies:[],countries:[],states:[]}),o=Nt(()=>{let{countries:s,currencies:l}=t;return!s.length||!l.length?{}:{"total.price":{label:e("common.total.price"),type:"text"},country:{label:e("common.country"),type:"select",fieldSettings:{listValues:s}},currency:{label:e("common.currency"),type:"select",fieldSettings:{listValues:l}},"totalPrice.centAmount":{label:e("common.total.price.cent.amount"),type:"number"},"totalPrice.currencyCode":{label:e("common.total.price.currency.code"),type:"select",fieldSettings:{listValues:l}},"taxedPrice.net":{label:e("common.net.taxed.price"),type:"text"},"taxedPrice.net.centAmount":{label:e("common.net.taxed.price.cent.amount"),type:"number"},"taxedPrice.net.currencyCode":{label:e("common.net.taxed.price.currency.code"),type:"select",fieldSettings:{listValues:l}},"taxedPrice.gross":{label:e("common.gross.taxed.price"),type:"text"},"taxedPrice.gross.centAmount":{label:e("common.gross.taxed.price.cent.amount"),type:"number"},"taxedPrice.gross.currencyCode":{label:e("common.gross.taxed.price.currency.code"),type:"select",fieldSettings:{listValues:l}},createdAt:{label:e("common.created.at"),type:"datetime"},"shippingAddress.firstName":{label:e("common.shipping.address.first.name"),type:"text"},"shippingAddress.lastName":{label:e("common.shipping.address.last.name"),type:"text"},"shippingAddress.streetName":{label:e("common.shipping.address.street.name"),type:"text"},"shippingAddress.streetNumber":{label:e("common.shipping.address.street.number"),type:"text"},"shippingAddress.additionalStreetInfo":{label:e("common.shipping.address.additional.street.info"),type:"text"},"shippingAddress.postalCode":{label:e("common.shipping.address.postal.code"),type:"text"},"shippingAddress.city":{label:e("common.shipping.address.city"),type:"text"},"shippingAddress.state":{label:e("common.shipping.address.state"),type:"text"},"shippingAddress.country":{label:e("common.shipping.address.country"),type:"select",fieldSettings:{listValues:s}},"billingAddress.firstName":{label:e("common.billing.address.first.name"),type:"text"},"billingAddress.lastName":{label:e("common.billing.address.last.name"),type:"text"},"billingAddress.streetName":{label:e("common.billing.address.street.name"),type:"text"},"billingAddress.streetNumber":{label:e("common.billing.address.street.number"),type:"text"},"billingAddress.additionalStreetInfo":{label:e("common.billing.address.additional.street.info"),type:"text"},"billingAddress.postalCode":{label:e("common.billing.address.postal.code"),type:"text"},"billingAddress.city":{label:e("common.billing.address.city"),type:"text"},"billingAddress.state":{label:e("common.billing.address.state"),type:"text"},"billingAddress.country":{label:e("common.billing.address.country"),type:"select",fieldSettings:{listValues:s}},"billingAddress.company":{label:e("common.billing.address.company"),type:"text"},"shippingInfo.shippingMethodName":{label:e("common.shipping.info.shipping.method.name"),type:"text"},"shippingInfo.price":{label:e("common.shipping.info.price"),type:"text"},"shippingInfo.price.centAmount":{label:e("common.shipping.info.price.cent.amount"),type:"number"},"shippingInfo.price.currencyCode":{label:e("common.shipping.info.price.currency.code"),type:"select",fieldSettings:{listValues:l}},"shippingInfo.shippingRate.price":{label:e("common.shipping.info.shipping.rate.price"),type:"text"},"shippingInfo.shippingRate.price.centAmount":{label:e("common.shipping.info.shipping.rate.price.cent.amount"),type:"number"},"shippingInfo.shippingRate.price.currencyCode":{label:e("common.shipping.info.shipping.rate.price.currency.code"),type:"select",fieldSettings:{listValues:l}},"shippingInfo.shippingRate.freeAbove":{label:e("common.shipping.info.shipping.rate.free.above"),type:"text"},"shippingInfo.shippingRate.freeAbove.centAmount":{label:e("common.shipping.info.shipping.rate.free.above.cent.amount"),type:"number"},"shippingInfo.shippingRate.freeAbove.currencyCode":{label:e("common.shipping.info.shipping.rate.free.above.currency.code"),type:"select",fieldSettings:{listValues:l}},"shippingInfo.taxRate.name":{label:e("common.shipping.info.tax.rate.name"),type:"text"},"shippingInfo.taxRate.amount":{label:e("common.shipping.info.tax.rate.amount"),type:"number"},"shippingInfo.taxRate.includedInPrice":{label:e("common.shipping.info.tax.rate.included.in.price"),type:"boolean"},"shippingInfo.taxRate.country":{label:e("common.shipping.info.tax.rate.country"),type:"select",fieldSettings:{listValues:s}},"shippingInfo.taxRate.state":{label:e("common.shipping.info.tax.rate.state"),type:"text"},"customer.email":{label:e("common.customer.email"),type:"text"},"customer.customerNumber":{label:e("common.customer.number"),type:"text"},"customer.customerGroup.key":{label:e("common.customer.group.key"),type:"text"},"customer.firstName":{label:e("common.customer.first.name"),type:"text"},"customer.lastName":{label:e("common.customer.last.name"),type:"text"},"customer.middleName":{label:e("common.customer.middle.name"),type:"text"},"customer.title":{label:e("common.customer.title"),type:"text"},"customer.isEmailVerified":{label:e("common.customer.is.email.verified"),type:"boolean"},"customer.externalId":{label:e("common.customer.external.id"),type:"text"},"customer.createdAt":{label:e("common.customer.created.at"),type:"datetime"}}},[t.countries,t.currencies]),i=Nt(()=>Object.keys(o).length>0,[o]);return Do(()=>{(async()=>{let s=await r.callAction({actionName:"project/getProjectSettings"});s.isError||n(s.data)})()},[]),{fields:o,isReady:i}},At=Io;import Q,{useCallback as Ft,useEffect as jo,useState as Oo}from"react";import{Utils as te,Query as Mo,Builder as Lo}from"@react-awesome-query-builder/ui";import Bo from"react";var St=()=>Bo.createElement("style",null,`
    .predicateBuilder .qb-drag-handler {
      display: none;
    }
    .predicateBuilder .group-or-rule-container.group-container {
      padding: 0.5rem;
      margin-top: 0.5rem;
      border-width: 1px;
    }
    .predicateBuilder .group--actions {
      display: flex;
      column-gap: 0.5rem;
      justify-content: flex-end;
    }
    .predicateBuilder .group--actions button {
      overflow: hidden;
      position: relative;
      padding-top: 0.5rem;
      padding-bottom: 0.5rem;
      padding-left: 1.5rem;
      padding-right: 1.5rem;
      border-radius: 4px;
      outline-offset: 0px;
      font-weight: 500;
      font-size: 0.75rem;
      line-height: 1rem;
      transition-property: background-color, border-color, color, fill, stroke, opacity, box-shadow, transform;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 300ms;
      background-color: rgb(23 58 95);
      color: #ffffff;
    }

    .predicateBuilder .group--conjunctions input[type='radio'],
    .predicateBuilder .rule--widget--BOOLEAN .widget--widget input[type='radio'] {
      display: none;
    }
    .predicateBuilder .group--conjunctions label,
    .predicateBuilder .rule--widget--BOOLEAN .widget--widget label {
      display: inline-block;
      line-height: 24px;
      padding-left: 0.25rem;
      padding-right: 0.25rem;
      border-width: 1px;
      border-radius: 4px;
      text-align: center;
      cursor: pointer;
      color: #000000;
    }
    .predicateBuilder .group--conjunctions input[type='radio']:checked + label,
    .predicateBuilder .rule--widget--BOOLEAN .widget--widget input[type='radio']:checked + label {
      color: #ffffff;
      background-color: rgb(23 58 95);
    }
    .predicateBuilder .rule {
      display: flex;
      margin-top: 0.5rem;
      align-items: center;
    }
    .predicateBuilder .rule .rule--body {
      display: flex;
      column-gap: 0.25rem;
      align-items: center;
      flex-wrap: nowrap;
    }
    .predicateBuilder .rule .rule--body .rule--value .rule--widget {
      display: flex;
      column-gap: 0.25rem;
      align-items: center;
    }
    .predicateBuilder .rule .rule--header button {
      display: flex;
      padding-top: 0.5rem;
      padding-bottom: 0.5rem;
      padding-left: 1.5rem;
      padding-right: 1.5rem;
      margin-left: 0.5rem;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      border-radius: 4px;
      border-width: 1px;
      border-color: transparent;
      font-size: 0.75rem;
      line-height: 1rem;
      font-weight: 500;
      color: #ffffff;
      background-color: rgb(205 63 80);
      transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 300ms;
      transition-duration: 200ms;
      transition-timing-function: cubic-bezier(0, 0, 0.2, 1);
    }
    .predicateBuilder .rule .rule--widget--DATETIME {
      display: flex;
      flex-direction: column;
    }
    .predicateBuilder .rule .rule--widget--TEXT input,
    .predicateBuilder .rule .rule--widget--DATETIME input,
    .predicateBuilder .rule .rule--widget--NUMBER input {
      display: flex;
      border-radius: 0.125rem;
      border-width: 1px;
      border-color: #d1d5db;
      color: #4b5563;
      background-color: #ffffff;
      padding-right: 0;
      padding-left: 0.75rem;
      width: 100%;
    }
    .predicateBuilder .rule .rule--operator select {
      display: flex;
      border-radius: 0.125rem;
      border-width: 1px;
      border-color: #d1d5db;
      color: #4b5563;
      background-color: #ffffff;
      padding-right: 0;
      padding-left: 0.75rem;
      width: 100%;
    }
    .predicateBuilder .rule .rule--field select {
      display: flex;
      border-radius: 0.125rem;
      border-width: 1px;
      border-color: #d1d5db;
      color: #4b5563;
      background-color: #ffffff;
      padding-right: 0;
      padding-left: 0.75rem;
      width: 100%;
    }
  `);import{useMemo as To}from"react";import{BasicConfig as $o}from"@react-awesome-query-builder/ui";var U=$o,Pt=r=>({config:To(()=>({...U,settings:{...U.settings,showNot:!1,showErrorMessage:!0,forceShowConj:!0,canReorder:!1,deleteLabel:"Remove rule",delGroupLabel:"Remove group"},types:{...U.types,text:{...U.types.text,valueSources:["value"]},select:{...U.types.select,valueSources:["value"]},number:{...U.types.number,valueSources:["value"]},boolean:{...U.types.boolean,valueSources:["value"]},datetime:{...U.types.datetime,valueSources:["value"]}},fields:r,widgets:{...U.widgets,text:{...U.widgets.text},datetime:{...U.widgets.datetime,spelFormatValue:t=>`"${new Date(t).toISOString()}"`}},operators:{...U.operators,equal:{...U.operators.equal,labelForFormat:"=",spelFormatOp:(t,n,o)=>`${t} = ${o}`},select_equals:{...U.operators.select_equals,labelForFormat:"=",spelFormatOp:(t,n,o)=>`${t} = ${o}`},not_between:{...U.operators.not_between,spelFormatOp:(t,n,o)=>`${t} < "${o[0]}" and ${t} > "${o[1]}"`},select_any_in:{...U.operators.select_any_in,spelFormatOp:(t,n,o)=>{let i=o.match(/\{(.*)\}\.\?\[true\]/);if(i?.[1]){let s=i[1].replaceAll("'","").split(",");return`${t} contains any (${s.map(l=>`"${l}"`).join(", ")})`}return""}},select_not_any_in:{...U.operators.select_not_any_in,spelFormatOp:(t,n,o)=>{let i=o.match(/\{(.*)\}\.\?\[true\]/);if(i?.[1]){let s=i[1].replaceAll("'","").split(",");return`not ${t} contains any (${s.map(l=>`"${l}"`).join(", ")})`}return""}}},conjunctions:{AND:{...U.conjunctions.AND,spelFormatConj:(t,n,o,i)=>(o&&(i=!1),t.size>1?(o?"!":"")+(i?"":"(")+t.join(" and ")+(i?"":")"):(o?"!(":"")+t.first()+(o?")":""))},OR:{...U.conjunctions.OR,spelFormatConj:(t,n,o,i)=>(o&&(i=!1),t.size>1?(o?"!":"")+(i?"":"(")+t.join(" or ")+(i?"":")"):(o?"!(":"")+t.first()+(o?")":""))}}}),[])});var Eo=({fields:r,translate:e,predicateJsonFormat:t,predicate:n,components:o,onUpdate:i,onUpdateJson:s,onError:l,onPreview:a})=>{let{config:d}=Pt(r),[p,y]=Oo({tree:te.checkTree(te.loadTree(t||{id:te.uuid(),type:"group"}),d),config:d}),v=Ft((g,m)=>{y(c=>({...c,tree:g,config:m}));try{let c=te.spelFormat(g,d);c&&i(c.replaceAll("'",'"'));let u=te.getTree(g);s(u)}catch(c){console.log(c)}},[i]);jo(()=>{if(d&&n){let g=n.replace(/(?<![<=>!])=(?!=)/g,"=="),[m,c]=te.loadFromSpel(g,d),u=te.checkTree(m,d);if(c.length){l();return}y({tree:u,config:d})}},[]);let h=Ft(g=>Q.createElement("div",{className:"query-builder-container mb-2"},Q.createElement("div",{className:"query-builder qb-lite"},Q.createElement(Lo,{...g}))),[]);return Q.createElement("div",{className:"w-full"},Q.createElement(St,null),Q.createElement("div",{className:"predicateBuilder max-h-[400px] overflow-x-hidden overflow-y-scroll"},Q.createElement(Mo,{...d,value:p.tree,onChange:v,renderBuilder:h})),Q.createElement("div",{className:"bordet-t border-primary-300"},Q.createElement(o.Button,{variant:"primary",size:"s",onClick:a,"data-cy":"predicate-preview-button"},e("dashboard.rule.predicate.preview"))))},Dt=Eo;var qo=Vo(()=>import("./approvers-preview-E4N7F4K6.js"),{ssr:!1}),zo=({components:r,sdk:e,rule:t,translate:n,roleOptions:o,activeBusinessUnit:i,permissions:s,storeKey:l,isEditing:a})=>{let{back:d,refresh:p}=Uo(),[y,v]=de(""),[h,g]=de(!1),[m,c]=de(!1),[u,b]=de({duplicate:!1,stateChange:!1,save:!1}),[x,w]=de(),{fields:D,isReady:O}=At(e,n),E=It(()=>t?{name:t.name,description:t.description,predicate:t.predicate,status:t.status,approvers:t.approvers,requesters:t.requesters}:{name:"",description:"",predicate:"",status:"Inactive",approvers:{tiers:[]},requesters:[]},[t]),[C,N]=de(E),F=It(()=>!s?.UpdateApprovalFlows,[s]),{activateRule:I,deactivateRule:A,createRule:B,updateRule:V}=K(e,i.key,l),W=async()=>{if(b({...u,stateChange:!0}),t.status==="Active")try{await A(t.id),N({...C,status:"Inactive"})}catch(j){console.error(j)}else try{await I(t.id),N({...C,status:"Active"})}catch(j){console.error(j)}b({...u,stateChange:!1}),p(),d()},R=kt(j=>{N({...C,[j.target.name]:j.target.value})},[C]),re=kt(j=>{let J=[...C.requesters??[]];J.some(he=>he.associateRole.key===j)?J=J.filter(he=>he.associateRole.key!==j):J=[...J,{associateRole:{key:j,typeId:"associate-role"}}],N({...C,requesters:J})},[C]),Le=j=>{N({...C,status:j?"Active":"Inactive"})},Tt=j=>{N({...C,approvers:{tiers:j}})},$t=j=>{N({...C,predicate:j})},jt=async()=>{if(b({...u,save:!0}),a)try{await V(t.id,C),p(),v("")}catch(j){v(j.message)}finally{b({...u,save:!1})}else try{await B(C),d(),v("")}catch(j){v(j.message)}finally{b({...u,save:!1})}},Ot=()=>{v("Predicate cannot be displayed in the query builder"),c(!0)};return S.createElement("div",{className:""},F&&S.createElement(r.InfoBanner,{className:"mt-3"},S.createElement("b",null,n("common.view.only"))," ",n("dashboard.rule.details.view.only.desc")),S.createElement("div",{className:"flex items-center justify-between"},S.createElement("h1",{className:"py-6 text-18 font-extrabold text-gray-800 md:py-7 md:text-20 lg:py-9 lg:text-24"},n("dashboard.rule.details")),S.createElement("div",{className:"flex items-center justify-normal gap-x-3"},S.createElement(r.PreviousPageLink,null),a&&S.createElement(S.Fragment,null,S.createElement(r.Button,{size:"s",variant:"warning",disabled:F,onClick:W,loading:u.stateChange},t.status==="Active"?n("dashboard.rule.details.deactivate"):n("dashboard.rule.details.activate"))),S.createElement(r.Button,{size:"s",variant:"primary",disabled:F,onClick:jt,loading:u.save},n("dashboard.rule.details.save")))),!!y&&S.createElement(r.InfoBanner,{className:"mt-3"},S.createElement("b",null,y)),S.createElement("form",{className:"grid grid-cols-6 gap-x-2 gap-y-4 py-8"},S.createElement("div",{className:"col-span-3"},S.createElement(r.Input,{name:"name",label:n("dashboard.rule.new.name"),disabled:F,required:!0,value:C.name??"",onChange:R})),S.createElement("div",{className:"col-span-3"},S.createElement(r.Input,{name:"description",label:n("dashboard.rule.new.description"),disabled:F,required:!0,value:C.description??"",onChange:R})),S.createElement("div",{className:"col-span-3"},S.createElement(r.Label,{required:!0},n("dashboard.roles")),S.createElement(r.RefinementDropdown,{disabled:F,options:o?.map(j=>({...j,selected:(C.requesters??[]).some(J=>J?.associateRole?.key===j.value)})),onChange:re},(C.requesters??[]).map(j=>j?.associateRole?.key).join(", "))),S.createElement("div",{className:"col-span-3 flex items-end"},S.createElement(r.Checkbox,{label:`${n("dashboard.rule.details.status")} = ${n(`dashboard.rules.status.${C.status.toLowerCase()}`)}`,disabled:F,checked:C.status==="Active",onChecked:Le})),S.createElement("h2",{className:"col-span-6 py-6 text-16 font-extrabold text-gray-800 md:py-7 md:text-18 lg:py-9 lg:text-20"},n("dashboard.rule.details.predicate")),!m&&O&&!F&&S.createElement("div",{className:"col-span-6"},S.createElement(Dt,{fields:D,components:r,translate:n,onError:Ot,predicate:C.predicate,predicateJsonFormat:x,onUpdate:$t,onUpdateJson:w,onPreview:()=>c(!0)})),(m||F)&&S.createElement(S.Fragment,null,S.createElement("div",{className:"col-span-5"},S.createElement(r.Input,{type:"text",name:"predicate",disabled:F||!a,label:n("dashboard.rule.new.predicate"),value:C?.predicate,onChange:R})),S.createElement("div",{className:"col-span-1 flex items-end"},S.createElement(r.Button,{variant:"secondary",type:"button",size:"m",disabled:F,onClick:()=>c(!1)},n("dashboard.rule.details.edit.predicate")))),S.createElement("h2",{className:"col-span-6 py-6 text-16 font-extrabold text-gray-800 md:py-7 md:text-18 lg:py-9 lg:text-20"},n("dashboard.rule.details.approvers")),S.createElement("div",{className:"col-span-6"},!h&&!a&&S.createElement(wt,{onUpdate:Tt,onPreview:()=>g(!0),tiers:C.approvers.tiers,associateRoles:o,translate:n,components:r}),(h||a)&&S.createElement(qo,{isPreview:a,tiers:C.approvers.tiers,onEdit:()=>g(!1),components:r,translate:n}))))},Bt=zo;var Wo={ApprovalFlowsPanel:ut,ApprovalRulesPanel:xt,ApprovalFlowsDetails:ht,ApprovalRulesDetails:Bt},Ho={useApprovals:K};export{Me as ApprovalWorkflows,ke as ConfigurableProducts,Be as SuperuserB2BFrontend,Fe as SuperuserFrontend};
